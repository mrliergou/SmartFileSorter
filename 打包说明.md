# 文件批量移动器 - 打包说明

## 项目简介

这是一个现代化的文件批量移动器应用程序，使用 CustomTkinter 构建了美观的用户界面。

## 主要改进

### 1. 现代化UI
- 使用 **CustomTkinter** 库替代原有的 PySimpleGUI/Tkinter
- 采用现代化的扁平设计风格
- 按钮使用不同颜色区分功能：
  - 绿色：添加/执行操作
  - 红色：删除/清空操作
  - 蓝色：扫描/移动操作
  - 紫色：规则管理
  - 灰色：关闭操作

### 2. 应用图标
- 创建了自定义图标（icon.ico）
- 图标设计：蓝色背景 + 橙色文件夹 + 绿色箭头
- 支持多种尺寸（16x16 到 256x256）

### 3. 功能特性
- 批量文件移动/复制
- 支持关键词过滤
- 规则管理器（添加/删除/排序规则）
- 规则建议功能（分析文件名词频）
- 递归扫描子文件夹
- 复制模式（保留原文件）
- 自动处理重名文件

## 安装依赖

在打包前，请先安装所需的依赖包：

```bash
pip install -r requirements.txt
```

或手动安装：

```bash
pip install customtkinter>=5.2.0
pip install Pillow>=10.0.0
pip install pyinstaller>=6.0.0
```

## 打包步骤

### 方法一：使用 spec 文件打包（推荐）

```bash
# 进入项目目录
cd "F:\行测\文件批量移动器"

# 使用 spec 文件打包
pyinstaller build.spec
```

### 方法二：使用命令行打包

```bash
# 进入项目目录
cd "F:\行测\文件批量移动器"

# 执行打包命令
pyinstaller --name="文件批量移动器" ^
    --onefile ^
    --windowed ^
    --icon=icon.ico ^
    --add-data "icon.ico;." ^
    --hidden-import="PIL._tkinter_finder" ^
    文件批量移动器_现代版.py
```

### 打包参数说明

- `--name`: 指定生成的exe文件名
- `--onefile`: 打包成单个exe文件
- `--windowed`: 不显示控制台窗口（GUI应用）
- `--icon`: 指定应用程序图标
- `--add-data`: 添加数据文件（图标）
- `--hidden-import`: 添加隐藏导入（PIL相关）

## 打包后的文件

打包完成后，会在 `dist` 目录下生成：
- `文件批量移动器.exe` - 可执行文件

## 运行说明

### 直接运行Python脚本

```bash
python 文件批量移动器_现代版.py
```

### 运行打包后的exe

双击 `dist\文件批量移动器.exe` 即可运行

## 使用说明

### 基本操作

1. **选择源文件夹**：点击"浏览"按钮选择要处理的文件所在的文件夹
2. **选择目标文件夹**：点击"浏览"按钮选择文件移动的目标位置
3. **设置文件类型**：输入要处理的文件扩展名，用逗号分隔（如：pdf,doc,docx）
4. **添加关键词**：输入关键词后点击"添加"，支持批量输入（用空格、逗号等分隔）
5. **扫描文件**：点击"扫描文件"按钮查看匹配的文件列表
6. **执行操作**：点击"执行移动/复制"按钮开始处理文件

### 高级功能

#### 规则管理器

点击"规则管理器"按钮可以：
- **添加规则**：设置关键词模式和目标子文件夹
- **删除规则**：删除不需要的规则
- **调整顺序**：上移/下移规则优先级
- **建议规则**：分析文件夹中的文件名，自动建议常用关键词

#### 选项设置

- **递归检测**：勾选后会扫描子文件夹中的文件
- **复制模式**：勾选后会复制文件而不是移动（保留原文件）

### 规则匹配

- 支持使用 `|` 分隔多个关键词（如：`试卷|卷子`）
- 文件名匹配任一关键词即可应用该规则
- 当多个规则匹配时，会弹窗让用户选择

## 配置文件

程序会在exe所在目录自动创建 `config.json` 配置文件，保存：
- 关键词列表
- 文件类型设置
- 规则列表
- 递归检测选项
- 复制模式选项

## 注意事项

1. **首次运行**：首次运行时可能需要等待几秒钟加载
2. **文件安全**：建议先使用"复制模式"测试，确认无误后再使用移动模式
3. **重名处理**：如果目标文件夹已存在同名文件，会自动重命名为 `文件名(1).扩展名`
4. **权限问题**：确保对源文件夹和目标文件夹有读写权限

## 故障排除

### 打包失败

如果打包失败，请检查：
1. 是否正确安装了所有依赖包
2. Python版本是否兼容（建议使用Python 3.8+）
3. 查看错误信息，可能需要安装额外的系统依赖

### 运行错误

如果exe运行出错：
1. 确保icon.ico文件与exe在同一目录
2. 检查是否有杀毒软件拦截
3. 尝试以管理员身份运行

### UI显示问题

如果界面显示异常：
1. 确保系统支持中文显示
2. 检查屏幕DPI设置
3. 尝试更新显卡驱动

## 技术栈

- **Python 3.x**
- **CustomTkinter** - 现代化UI框架
- **Pillow** - 图像处理（图标）
- **PyInstaller** - 打包工具

## 文件结构

```
文件批量移动器/
├── 文件批量移动器.py              # 原始版本
├── 文件批量移动器_现代版.py        # 现代化版本（推荐）
├── create_icon.py                 # 图标生成脚本
├── icon.ico                       # 应用图标
├── icon.png                       # 图标PNG版本
├── build.spec                     # PyInstaller配置文件
├── requirements.txt               # 依赖包列表
├── 打包说明.md                    # 本文件
├── config.json                    # 配置文件（运行后自动生成）
└── dist/                          # 打包输出目录
    └── 文件批量移动器.exe         # 可执行文件
```

## 版本信息

- **版本**: 2.0 现代化版
- **更新日期**: 2025-12-03
- **作者**: Claude Code

## 许可证

本项目仅供学习和个人使用。
